# API для интернет-магазина Megano (в работе!!!)

Проект представляет собой монолитный API для интернет-магазина, написан с использованием Django Rest Framework.
Frontend реализован на Vue3.

## Оглавление
1. [Инструменты](#Инструменты)
2. [Приложения](#Приложения)
3. [Запуск проекта](#Запуск)
   4. [В режиме разработки](#Dev)

## Инструменты
* **Python** (3.11);
* **Django Rest Framework** (Web Framework for API);
* **PostgreSQL** (database);
* **Vue3** (Frontend Framework).

## Приложения

### Auth (user_auth)

Отвечает за регистрацию, авторизацию и выход из учетной записи пользователя.

### Profile (user_profile)

Отвечает за вывод и обновление профиля пользователя, обновление аватара и пароля.

## Запуск

1. Копируем содержимое репозитория в отдельный каталог:
```
git clone https://github.com/FreemaHG/django-shop-api-new.git
```

### Dev

2. Переименовываем файл "**.env.dev.template**" в "**.env**", при необходимости можно задать свои параметры.

3. Запускаем контейнер с БД:
```
docker-compose up -d postgres
```

4. Применяем миграции:
```
python3 -m backend.manage migrate
```

5. Создание суперпользователя:
```
python3 -m backend.manage createsuperuser
```

6. Запускаем сервер:
```
python3 -m backend.manage runserver
```

Приложение будет доступно по адресу: `http://127.0.0.1:8000/`

**Админка**: `http://127.0.0.1:8000/admin/`

**Документация API**: `http://127.0.0.1:8000/swagger/`


#### Pre-commit

В проекте используются Git-хуки для автоматической проверки и форматирования кода перед созданием коммита.

**ВАЖНО**: на локальной машине разработчика должен быть установлен пакет **pre-commit**:
   ```
   pip install pre-commit
   ```

Применяемые хуки описаны в корне проекта в файле .pre-commit-config.yaml

Для активации хуков вводим:
   ```
   pre-commit install
   ```
Предварительная проверка и форматирование кода:
   ```
   pre-commit run --all-files
   ```

#### Тесты

**Теги**:
* anonymous - тесты, проверяющие ответ при обращении неавторизованным пользователем

* create - тесты, проверяющие корректность создания новых записей
* get - тесты, проверяющие корректность возвращаемых данных
* update - тесты, проверяющие обновление данных приложения

* profile - тесты, проверяющие возврат и обновление профиля
* password - тесты, проверяющие обновление пароля
* registration - тесты, проверяющие регистрацию пользователя
* login - тесты, проверяющие авторизацию пользователя
* logout - тесты, проверяющие выход пользователя из своей учетной записи

* not_found - тесты, проверяющие сообщение при отсутствии данных для вывода или обновления
* invalid_data - тесты, проверяющие обработку при передаче невалидных данных
* exception - тесты, проверяющие сообщения в случае возникновения ошибок

* cache - тесты, проверяющие корректность сохранения и очистки кэша

* utils - тестирование утилит приложений
* urls - тестирование корректности совершения запросов по urlname
* business - тестирование бизнес-логики
* services - тестирование сервисного слоя
* views - тестирование представлений
* serializers - тестирование схем
* repositories - тестирование слоя "репозиторий"

Запуск тестов:
   ```
   python3 -m backend.manage test
   ```

Запуск тестов с тегом "profile":
   ```
   python3 -m backend.manage test --tag=profile
   ```
